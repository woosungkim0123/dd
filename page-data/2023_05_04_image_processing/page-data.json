{"componentChunkName":"component---src-templates-post-template-tsx","path":"/2023_05_04_image_processing/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h1>주요 포인트</h1>\n<p>이번 글에서는</p>\n<ul>\n<li><strong>고용량 이미지로 인한 로딩 속도 문제를 해결한 경험</strong></li>\n<li><strong>그 과정에서 발생한 일에 대한 회고</strong></li>\n<li><strong>더 나은 해결책</strong></li>\n</ul>\n<p>에 대해 이야기 해보겠습니다.</p>\n<h1>시작하기 전</h1>\n<p>웹 뷰 모바일 앱을 개발하면서 고용량의 이미지로 인해 페이지 로딩 속도가 현저하게 느려지는 문제를 만나게 되었습니다. 이 문제를 해결하기 위해 Sharp 라이브러리를 도입하여 이미지 압축을 실행했고, 이를 통해 성능 문제를 개선할 수 있었습니다.</p>\n<br>\n<p>개인적으로, 라이브러리를 도입하여 문제를 해결한 것이 큰 성과라고 생각하지는 않지만, 라이브러리를 도입하는 과정에 진행한 <strong>Node 버전 업그레이드</strong>, <strong>버전 호환을 위한 대량의 코드 수정</strong> 그리고 <strong>이미지를 저장하는 방식</strong>, <strong>이미지 처리 방법</strong> 등에 대해 회고 해볼 필요가 있다고 생각했습니다.</p>\n<br>\n<p>먼저 당시 상황에 대해 간략히 이야기 해보겠습니다.</p>\n<h1>문제 발생</h1>\n<p>스크롤 형식의 게시판에서 한 게시물 당 최대 5개의 이미지를 목록에서 보여주도록 변경하였고, 카메라로 촬영한 사진을 바로 등록할 수 있도록 기존 2MB 제한을 풀어 10MB로 늘렸습니다.</p>\n<br>\r\n<br>\r\n<center>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 177px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/469bbc9f64fa6c7aad0897b1b516c1fb/ad6ca/2023_05_04_image_processing_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 202.2598870056497%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/469bbc9f64fa6c7aad0897b1b516c1fb/5cd3b/2023_05_04_image_processing_1.webp 177w\"\n              sizes=\"(max-width: 177px) 100vw, 177px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/469bbc9f64fa6c7aad0897b1b516c1fb/ad6ca/2023_05_04_image_processing_1.png 177w\"\n            sizes=\"(max-width: 177px) 100vw, 177px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/469bbc9f64fa6c7aad0897b1b516c1fb/ad6ca/2023_05_04_image_processing_1.png\"\n            alt=\"당시 앱 상황 예시\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</center>\r\n<br>\r\n<br>\n<p>카메라로 직접 촬영한 사진을 게시하는 경우가 많았는데, 이 경우 파일 크기가 평균 3MB에 달했습니다. 이런 상황에 여러 사진들이 게시물 목록에 동시에 표시되면서, 모바일 환경에서 페이지 로딩 속도가 평균 3초로 눈에 띄게 느려졌습니다.</p>\n<br>\r\n<br>\r\n<center>\n<p><img src=\"/3b4e9e94acb51336fe33e2ddf80b4ea5/2023_05_04_image_processing_2.gif\" alt=\"성능 개선 전\"></p>\n</center>\r\n<br>\r\n<br>\n<p>한 번에 불러오는 게시물의 수를 10개까지 줄여보았지만, 성능적으로 유의미한 결과를 얻을 수 없었습니다.</p>\n<h1>Sharp 도입을 통한 개선</h1>\n<p>이를 개선해달라는 지속적인 피드백이 있었지만 당시 프로젝트 Node.js 버전이 0.10 으로 압축 라이브러리 등의 다른 서드 파티의 도움을 받기가 쉽지 않았습니다.</p>\n<br>\n<p>그래서 Node 버전을 14까지 올리고 이미지 압축 라이브러리인 Sharp를 도입해 로딩 속도를 3초에서 1초 밑으로 개선할 수 있었습니다.</p>\n<br>\n<p><strong>Sharp 사용시 이미지 용량 변화</strong></p>\n<p>1.47MB => 58.1KB</p>\n<br>\r\n<br>\r\n<center>\n<p><img src=\"/84e53397359f47c7d54c7d537d172836/2023_05_04_image_processing_3.gif\" alt=\"성능 개선 후\"></p>\n</center>\r\n<br>\r\n<br>\n<h1>회고 및 개선</h1>\n<p>당시에는 이 방법이 효과적이었으며, 큰 문제 없이 원하는 결과를 얻을 수 있었습니다.</p>\n<br>\n<p>하지만 시간이 지나고 다시 돌아보니, 단순히 문제를 해결했다는 것 이상으로 많은 생각과 개선 가능성에 대해 고민하게 되었습니다.</p>\n<br>\n<p>어떤 부분에서 많은 생각이 들고, 개선 가능성이 있는지에 대해 이야기 해보겠습니다.</p>\n<h2>1. 이미지를 서버 자체에 저장</h2>\n<h3>회고</h3>\n<br>\r\n<br>\r\n<center>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 538px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/748f3c30e25ac49bb11af77782aec1c7/32ca7/2023_05_04_image_processing_4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAApUlEQVR42iWO2Q6FIAxE+f+P88kXEowSBUXRuECuu/dEm9CW6XQ6whiTZZmUsu/7bdt+b6zrGmMEeZ7nvu8vg0M4jmPfdwj0gs00TZMk6bpuWZZpmoZhIIcQrLVN01RVVdd1nufOuXme+cJk2rat4GmtkQDiFNl7DziOY1mW+GJaFIVSCoSzKMK5rguyoOAKSwhjNbxBw3EkGH2E8zxZ/hwR9DHGP2nA3+2QzHhkAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/748f3c30e25ac49bb11af77782aec1c7/a59e9/2023_05_04_image_processing_4.webp 192w,\n/static/748f3c30e25ac49bb11af77782aec1c7/0ca9f/2023_05_04_image_processing_4.webp 384w,\n/static/748f3c30e25ac49bb11af77782aec1c7/d17f0/2023_05_04_image_processing_4.webp 538w\"\n              sizes=\"(max-width: 538px) 100vw, 538px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/748f3c30e25ac49bb11af77782aec1c7/3b721/2023_05_04_image_processing_4.png 192w,\n/static/748f3c30e25ac49bb11af77782aec1c7/66595/2023_05_04_image_processing_4.png 384w,\n/static/748f3c30e25ac49bb11af77782aec1c7/32ca7/2023_05_04_image_processing_4.png 538w\"\n            sizes=\"(max-width: 538px) 100vw, 538px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/748f3c30e25ac49bb11af77782aec1c7/32ca7/2023_05_04_image_processing_4.png\"\n            alt=\"단일 서버 구조\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</center>\r\n<br>\r\n<br>\n<p>해당 서비스는 파일 저장을 위해 단일 서버 구조를 가지고 있었습니다.</p>\n<br>\n<p>당시의 요구를 충족시키기에는 충분했지만, 서비스가 지속적으로 성장하고 있는 상황을 고려하면 단일 서버 구조는 확장 즉, <strong>Scale Out</strong> 을 고려하지 않는 판단이였던 것 같습니다.</p>\n<br>\n<p>만약 해당 서비스가 이대로 <strong>Scale Out</strong> 을 진행한다고 가정해보겠습니다.</p>\n<br>\r\n<br>\r\n<center>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 608px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9aba04d52ae05bb546f923b622e90f65/5db90/2023_05_04_image_processing_5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA6ElEQVR42o2R626FIBCEff+HPEXxRhUEEQTShY6YJk2a9Pj9IBvZ2RmXppRCOUetPWNBqS+iknN5RsM5X5bFO3cY445j3/eU0lPxPM9CCGPMKuWmtZSSMZafmTdEpJTSWm8V1BgE/xjje3HbttM0QaArcL5jHxWMSJUQwrUdIhT4eJ/NUrliryuccX68XtZa51zf97zrhmHoOIfHOI74QVyhQBtsrtgIeZ6nr6CGIUxCSsbazZjtVyK4QWwq6GzGyucPmI2mMwQjBHmfrUXWN9vGbIS/N4eEzvsSYw6BnPtP/Dc29A/f+Rst+kJRNPPFcQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9aba04d52ae05bb546f923b622e90f65/a59e9/2023_05_04_image_processing_5.webp 192w,\n/static/9aba04d52ae05bb546f923b622e90f65/0ca9f/2023_05_04_image_processing_5.webp 384w,\n/static/9aba04d52ae05bb546f923b622e90f65/dfa82/2023_05_04_image_processing_5.webp 608w\"\n              sizes=\"(max-width: 608px) 100vw, 608px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9aba04d52ae05bb546f923b622e90f65/3b721/2023_05_04_image_processing_5.png 192w,\n/static/9aba04d52ae05bb546f923b622e90f65/66595/2023_05_04_image_processing_5.png 384w,\n/static/9aba04d52ae05bb546f923b622e90f65/5db90/2023_05_04_image_processing_5.png 608w\"\n            sizes=\"(max-width: 608px) 100vw, 608px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9aba04d52ae05bb546f923b622e90f65/5db90/2023_05_04_image_processing_5.png\"\n            alt=\"상태가 있는 서버 구조\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</center>\r\n<br>\r\n<br>\n<p>만약 서비스가 수평적 확장을 통해 여러 서버에 파일 저장 기능을 분산시킨 경우, 각 서버는 고유한 데이터 상태를 가지게 될 것입니다. 이는 데이터 일관성 문제를 야기할 수 있습니다.</p>\n<br>\n<p>예를 들어, 사용자가 ‘image1’을 삭제하도록 요청했으나, 이 요청이 ‘image1’파일이 없는 서버로 전송될 경우, 삭제 작업이 제대로 이루어지지 않을 수 있습니다.</p>\n<br>\n<p>그리고 만약 클라우드 환경이면 이미지 때문에 부하가 없음에도 불구하고 인스턴스를 유지해야하는 상황도 발생할 수 있습니다.</p>\n<br>\n<h3>개선 방법</h3>\n<br>\r\n<br>\r\n<center>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/263171b379fe9747bb5cab5a09a1b0a0/d2c78/2023_05_04_image_processing_6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.29166666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA/UlEQVR42oWSjQ6DIAyEff/XNHHGnwkMUUHcPqmyJWbxkjWl7fXazuJ9QfBeGdsq65yLMb7/o+A3TdM4ji4BfxgGrZXRCqdpmhsynHVdcbZtw1pru77vnzukXQghJkhBPHEoZ8zzrE6g3HXdsizoV1X1SJAUEWPMToaAWl4PH2GYKJPy3r8SbAJPNGCSOsjszORE0RHNtLnGkpVpf8E6351pDI0WPLEoYGkP/3oneh1kGstulDInt8knoYhxqKNGzoEVvsgU9EbHnGjbVuoAs+yXT5ArkKWG+KHMhryxTI6VllvC/sGEQDwvgs/BGEeyRXWiruuyLGmU//BbfAAgg35ooc0I6wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/263171b379fe9747bb5cab5a09a1b0a0/a59e9/2023_05_04_image_processing_6.webp 192w,\n/static/263171b379fe9747bb5cab5a09a1b0a0/0ca9f/2023_05_04_image_processing_6.webp 384w,\n/static/263171b379fe9747bb5cab5a09a1b0a0/dc9b9/2023_05_04_image_processing_6.webp 768w,\n/static/263171b379fe9747bb5cab5a09a1b0a0/65d6a/2023_05_04_image_processing_6.webp 812w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/263171b379fe9747bb5cab5a09a1b0a0/3b721/2023_05_04_image_processing_6.png 192w,\n/static/263171b379fe9747bb5cab5a09a1b0a0/66595/2023_05_04_image_processing_6.png 384w,\n/static/263171b379fe9747bb5cab5a09a1b0a0/fe486/2023_05_04_image_processing_6.png 768w,\n/static/263171b379fe9747bb5cab5a09a1b0a0/d2c78/2023_05_04_image_processing_6.png 812w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/263171b379fe9747bb5cab5a09a1b0a0/fe486/2023_05_04_image_processing_6.png\"\n            alt=\"CDN, S3 사용\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</center>\r\n<br>\r\n<br>\n<p>이 문제에 있어서는 Amazon S3(Simple Storage Service)와 같은 별도의 스토리지 솔루션을 사용하는 것이 좋은 방법이 될 것 같습니다.</p>\n<br>\n<p>그러나 위 그림처럼 클라이언트에서 백엔드 서버로 파일을 전송한 뒤, 백엔드 서버에서 S3로 다시 파일을 전송하는 구조는 추가적인 네트워크 통신이 발생하기 때문에 성능적인 문제를 야기할 수 있습니다.</p>\n<br>\n<p>그렇다고 프론트에서 직접 S3로 보내는 방법은 성능적인 이점을 제공하지만 보안적인 이슈가 따라올 수 밖에 없습니다.</p>\n<br>\r\n<br>\r\n<center>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 624px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/83e5c9a83d1bc0ff33733b8f0840de74/08d47/2023_05_04_image_processing_7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA7ElEQVR42m1RiY6DIBTk/79xa+yuMXTlBhFFHh3ptumxE/IyROfIgxljcs7rHeDee5DakJ+wbVt9BXPOhRC01nBRSoEE75I41aTL/KumURurlNQaHxURvYittTFG6BEIAnvM5EXdYwkXdRmUNkJI2DZxqZUeh3HOu64bx7Hveykl/JZlSSmBIOdggJ/SbMD/SQ4NSMaECyz2fa9NfZs0c1pdLbnor6JPxzF9cQOjJ+BPeGELWFgp5S+HdvID5XjQHGn1MDquObL6ASz23ID+t1JG8uDtHON77U8xOqM5KoCDYE/n759JCDzEm/gKFcrPfqh7egoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/83e5c9a83d1bc0ff33733b8f0840de74/a59e9/2023_05_04_image_processing_7.webp 192w,\n/static/83e5c9a83d1bc0ff33733b8f0840de74/0ca9f/2023_05_04_image_processing_7.webp 384w,\n/static/83e5c9a83d1bc0ff33733b8f0840de74/5f6bc/2023_05_04_image_processing_7.webp 624w\"\n              sizes=\"(max-width: 624px) 100vw, 624px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/83e5c9a83d1bc0ff33733b8f0840de74/3b721/2023_05_04_image_processing_7.png 192w,\n/static/83e5c9a83d1bc0ff33733b8f0840de74/66595/2023_05_04_image_processing_7.png 384w,\n/static/83e5c9a83d1bc0ff33733b8f0840de74/08d47/2023_05_04_image_processing_7.png 624w\"\n            sizes=\"(max-width: 624px) 100vw, 624px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/83e5c9a83d1bc0ff33733b8f0840de74/08d47/2023_05_04_image_processing_7.png\"\n            alt=\"Pre-Signed URL 사용\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</center>\r\n<br>\r\n<br>\n<p>이 문제에 대해서는 임시 엑세스 권한을 부여하는 방식인 <strong>Pre-Signed URL</strong> 방식을 사용해서 해결할 수 있습니다.</p>\n<ol>\n<li>\n<p>백엔드 서버에서 AWS의 자격증명을 사용하는 <strong>Pre-Signed URL</strong> 을 생성하고 이를 클라이언트에 전달합니다.</p>\n</li>\n<li>\n<p>클라이언트는 이 URL을 통해 지정된 시간 동안 S3 버킷에 파일을 직접 업로드 할 수 있습니다.</p>\n</li>\n<li>\n<p>S3 에 업로드 후 서버를 통해 데이터베이스에 파일 정보를 저장합니다.</p>\n</li>\n</ol>\n<br>\r\n<br>\r\n<center>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/61b9255a1dba4810e7d93e0febd689d8/a27c6/2023_05_04_image_processing_8.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAACHVAAAh1QEEnLSdAAABjUlEQVR42m1Sa2+EIBD0//+zfu2l1zZ9eSiIgOKDU0SwHeXO2qQTJbrszLKzJNM0nc9nQggvuHPu+z8sy/JvPMHLikIq1WwwxnjvEcQaQohJVVVZaxFBpev1OgzDjQxVIUrOOTKUUpTSVaPtur4PG+Z57vseomVZ5nle1zXSxnG8VdZaF0UhhIDEJU0LzvPTg+ka52Y0EvlZliEHfL0BWqiaxJbcNLVNg+2c5ljdOCAKGrbAlFJ261FWtG2LyO+xdwP8DtA20WWTqLWOhBA8PpY7EuwZ08MDmBFTfXw2wyIQx99ddgU+VrKb/ePTM2MUHiFtd/gI6O7x40kTHxbCeLRBwfG6bs2ADDOMd8IipCKy1Z1B5+2GKLGSPwhllGIGXaMvJGOiolnGZLOXstP0SsrHN5KSrEENpeDcze1PXpdCirJ8+STp5ZJSLt9Pi3eHYzvG2AdhlAuta9RHI7c5bzYGO46oiamAWxl7uJzhK6Oqwc2bcTcw4b3/OOc/9sBc6/zxYk/WxibjhHbDfgBDYO5W+QmShwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/61b9255a1dba4810e7d93e0febd689d8/a59e9/2023_05_04_image_processing_8.webp 192w,\n/static/61b9255a1dba4810e7d93e0febd689d8/0ca9f/2023_05_04_image_processing_8.webp 384w,\n/static/61b9255a1dba4810e7d93e0febd689d8/84c6d/2023_05_04_image_processing_8.webp 700w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/61b9255a1dba4810e7d93e0febd689d8/3b721/2023_05_04_image_processing_8.png 192w,\n/static/61b9255a1dba4810e7d93e0febd689d8/66595/2023_05_04_image_processing_8.png 384w,\n/static/61b9255a1dba4810e7d93e0febd689d8/a27c6/2023_05_04_image_processing_8.png 700w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/61b9255a1dba4810e7d93e0febd689d8/a27c6/2023_05_04_image_processing_8.png\"\n            alt=\"CDN\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</center>\r\n<br>\r\n<br>\n<p>추가로 웹 콘텐츠의 로딩 속도와 사용자 경험을 더욱 향상시키기 위해 AWS CloudFront와 같은 CDN을 고려하는 것도 좋은 방법일 것 같습니다.</p>\n<br>\n<p>CDN을 사용하면 처음에는 멀리 떨어진 S3 같은 저장소에서 데이터를 불러오지만, 이 과정에서 데이터를 사용자에게 가까운 캐시 서버에 저장하게 됩니다. 이후 요청부터는 가까운 캐시 서버에서 데이터를 불러오기 때문에 로딩 시간이 크게 단축되고, 전체적인 웹사이트의 반응 속도가 개선될 것입니다.</p>\n<br>","frontmatter":{"title":"이미지 처리를 통한 성능 개선 회고","summary":"이미지 처리를 통한 성능 개선 경험에 대한 회고","date":"2023.05.04.","categories":["Web","Optimization","Image"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/webp;base64,UklGRmYCAABXRUJQVlA4IFoCAABQDwCdASoUABQAAAAAJbACdMoRwN4B+Nf4k9FS8uiAfyvdAfpv+oG+AdZn6AH7Aekz+uXwP/uD6LdHV/DPJQPVfyA0Rn9V/Df8o8tQ/EbVDf6j+Tuut/wH43e6xnmeOf8l7gX8P/j395/q/7T8ZB+tx2UaWjntN/aLbZPHU8DIYBwWOAD+//9whesSV3Jt7Wp6X4BqQgo393FwOFllScJQf//4+JY17ffyd9Ar3DmqP8iXGEn2lDPr1iLCXzfp2b91/jNZedPoY4SyCHiN7MRrQbATf0PDOLxi9I30nQT+ZKf9h17x0DQaEN+PSTDUv6/k11snZxlG6Y7g19tVcw/cOCDdFbfO875WU8g7nzquI7eXibP1t5tj232KYY5u56sZia7FW536xaqjNWtIhemdKTPFVLggbWG1YpBbKAb8ntDh2L51VN/gN3wwFohnbD9wq4/DyD5iGfx68PxTtMB/E/5yK96bUZGTynza2OdD/tfzv/SdmABKS3WfFr/8iqa4s3/v7wXcXCR//aEUEs9EUqIoff/hKik8J/0ltMPqfXr2UBty54M0hvuL7qjgb3jCrrseO+D289I3EN8sQXXsybwAsRBErqpAiGp0xZdHPSPlgiw/GDnaycXvXW/DXM/Qbeu9I3+j4XHvvw172V/CiebKB4UnNl+ygdmX1w6lb4jdH6HOXekufHUX21SuF3Nu+qO8GIppgL/amaE9AVXfpEjk2IpvGPGhungVj7r64jeNGgHLmv/9Sc7PNePvNxK1PXpBLt4n4+Y6L4BME4P3cG2EmmKTGLCAAA=="},"images":{"fallback":{"src":"/static/28c821d7ad2ed2c7ad9a7f1d1256aacd/e306d/2023_05_04_image_processing_main.webp","srcSet":"/static/28c821d7ad2ed2c7ad9a7f1d1256aacd/99d55/2023_05_04_image_processing_main.webp 256w,\n/static/28c821d7ad2ed2c7ad9a7f1d1256aacd/3591c/2023_05_04_image_processing_main.webp 512w,\n/static/28c821d7ad2ed2c7ad9a7f1d1256aacd/e306d/2023_05_04_image_processing_main.webp 1024w","sizes":"(min-width: 1024px) 1024px, 100vw"},"sources":[]},"width":1024,"height":1024}},"publicURL":"/static/28c821d7ad2ed2c7ad9a7f1d1256aacd/2023_05_04_image_processing_main.webp"}}}}]}},"pageContext":{"slug":"/2023_05_04_image_processing/"}},"staticQueryHashes":[],"slicesMap":{}}
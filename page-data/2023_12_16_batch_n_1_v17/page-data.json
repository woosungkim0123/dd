{"componentChunkName":"component---src-templates-post-template-tsx","path":"/2023_12_16_batch_n_1_v17/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h1></h1>\n<p>기존 Spring Batch에서 JPA 사용시 발생하는 N+1 문제에 대해서 JDK 17, Spring Batch 5.0 이상 버전에서 발생하는 변경점을 확인하고자 합니다.</p>\n<h2>이전 글</h2>\n<p>Spring Batch에서 JPA 사용시 발생하는 N+1 문제 (JDK 11, Batch 4.2)  <a href=\"https://woosungkim0123.github.io/2023_12_12_batch_n_1/\" target=\"_blank\"><strong>블로그 글</strong></a>, <a href=\"https://github.com/woosungkim0123/spring-batch-deep-dive/tree/main/n_1_v11\" target=\"_blank\"><strong>Github(Code)</strong></a></p>\n<h1>Batch 5.0 이상 변경점</h1>\n<p>코드:\r\n<a href=\"https://github.com/woosungkim0123/spring-batch-deep-dive/tree/main/n_1_v17/\" target=\"_blank\"><strong>\r\nGithub</strong></a></p>\n<br>\n<p>기존 코드에서 필요하다고 생각되는 부분만 다루었습니다.</p>\n<p>자세한 정보를 보시려면 <a href=\"https://github.com/spring-projects/spring-batch/wiki/Spring-Batch-5.0-Migration-Guide\" target=\"_blank\"><strong>링크</strong></a>를 참조해주세요.</p>\n<h2>Database 스키마 수정</h2>\n<p>Batch 5.0 이전 버전의 스키마를 그대로 사용하면 에러가 발생합니다.</p>\n<h3>1. JOB_CONFIGURATION_LOCATION</h3>\n<p>BATCH_JOB_EXECUTION 테이블 JOB_CONFIGURATION_LOCATION 열이 더이상 사용되지 않습니다.</p>\n<br>\r\n<center>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/70a7aa87b74870f29c9361b0e45b6174/c7d76/schema_change1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.1875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAkklEQVR42mWOSw6DIABEPUBroFVBoHwUSpCKf0009v7HqnXRTZOXybzVTMRLV4XxoWyCRUbkiUKsPEqai3vGYoguIPvnClFEuJals6+h7tcwrO28h2nz7RKGLYyrq0fMCpDkMKU/wJnxDUdMWe0a30z9/O6W3VSd1B5RpbQvbPiq8ccA4eZ4R4Vh8kmE4YUFCfkAt5QWtYrSYsEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/70a7aa87b74870f29c9361b0e45b6174/a59e9/schema_change1.webp 192w,\n/static/70a7aa87b74870f29c9361b0e45b6174/0ca9f/schema_change1.webp 384w,\n/static/70a7aa87b74870f29c9361b0e45b6174/dc9b9/schema_change1.webp 768w,\n/static/70a7aa87b74870f29c9361b0e45b6174/3e9ea/schema_change1.webp 891w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/70a7aa87b74870f29c9361b0e45b6174/3b721/schema_change1.png 192w,\n/static/70a7aa87b74870f29c9361b0e45b6174/66595/schema_change1.png 384w,\n/static/70a7aa87b74870f29c9361b0e45b6174/fe486/schema_change1.png 768w,\n/static/70a7aa87b74870f29c9361b0e45b6174/c7d76/schema_change1.png 891w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/70a7aa87b74870f29c9361b0e45b6174/fe486/schema_change1.png\"\n            alt=\"JOB_CONFIGURATION_LOCATION 사용 안됨\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</center>\r\n<br>\n<p>5.0버전에서 해당 칼럼을 사용하는 Spring Batch의 유일한 부분인 JSR-352가 채택 부족으로 구현이 제거됨에 따라 사용처가 없어졌습니다.</p>\n<br>\r\n<center>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c272df3caf5d9f672381b78b5bb09c9c/b5dc4/schema_change2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.583333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAApElEQVR42j2L3QqCMACFvS0qJEQqtfkzc7qpmzqn6RIvEkKiiy56/zdpIQSH7+Kc72iOjxwPHY7ABiGAieVeFB0vsr0IBPHZR4pumAQogyh3IVbrr4HYPLla1Q5M9Iz3RS1p1VHelUIWQpbiJsfH/PpM83ucntfhnhbt/wyWM2ENoUIRM4HzWhkoLTGtSdEkGae8hzFVAiKVblir7X69M5ZsdPMLtHQdyX+SO4cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c272df3caf5d9f672381b78b5bb09c9c/a59e9/schema_change2.webp 192w,\n/static/c272df3caf5d9f672381b78b5bb09c9c/0ca9f/schema_change2.webp 384w,\n/static/c272df3caf5d9f672381b78b5bb09c9c/dc9b9/schema_change2.webp 768w,\n/static/c272df3caf5d9f672381b78b5bb09c9c/f3bfb/schema_change2.webp 915w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c272df3caf5d9f672381b78b5bb09c9c/3b721/schema_change2.png 192w,\n/static/c272df3caf5d9f672381b78b5bb09c9c/66595/schema_change2.png 384w,\n/static/c272df3caf5d9f672381b78b5bb09c9c/fe486/schema_change2.png 768w,\n/static/c272df3caf5d9f672381b78b5bb09c9c/b5dc4/schema_change2.png 915w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c272df3caf5d9f672381b78b5bb09c9c/fe486/schema_change2.png\"\n            alt=\"JOB_CONFIGURATION_LOCATION 사용 안됨 - 중요\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</center>\r\n<br>\n<h3>2. BATCH_JOB_EXECUTION_PARAMS의 열 변경</h3>\n<p><a href=\"https://github.com/spring-projects/spring-batch/issues/3960\" target=\"_blank\"><strong> Issue #3960 </strong></a> 에서 Spring Boot 사용자에게 친숙한 Parameter 변경 제안이 있었는데 이를 반영한 것으로 보입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> BATCH_JOB_EXECUTION_PARAMS  <span class=\"token punctuation\">(</span>\r\n    JOB_EXECUTION_ID <span class=\"token keyword\">BIGINT</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token punctuation\">,</span>\r\n    <span class=\"token comment\">--\tTYPE_CD VARCHAR(6) NOT NULL , -- 제거</span>\r\n    <span class=\"token comment\">--\tKEY_NAME VARCHAR(100) NOT NULL , -- 제거</span>\r\n    <span class=\"token comment\">--\tSTRING_VAL VARCHAR(250) , -- 제거</span>\r\n    <span class=\"token comment\">--  DATE_VAL DATETIME(6) DEFAULT NULL , -- 제거</span>\r\n    <span class=\"token comment\">--\tLONG_VAL BIGINT , -- 제거</span>\r\n    <span class=\"token comment\">--\tDOUBLE_VAL DOUBLE PRECISION , -- 제거</span>\r\n    PARAMETER_NAME <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token punctuation\">,</span> <span class=\"token comment\">-- **추가**</span>\r\n    PARAMETER_TYPE <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token punctuation\">,</span> <span class=\"token comment\">-- **추가**</span>\r\n    PARAMETER_VALUE <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">2500</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span> <span class=\"token comment\">-- **추가**</span>\r\n    IDENTIFYING <span class=\"token keyword\">CHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token keyword\">constraint</span> JOB_EXEC_PARAMS_FK <span class=\"token keyword\">foreign</span> <span class=\"token keyword\">key</span> <span class=\"token punctuation\">(</span>JOB_EXECUTION_ID<span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">references</span> BATCH_JOB_EXECUTION<span class=\"token punctuation\">(</span>JOB_EXECUTION_ID<span class=\"token punctuation\">)</span></code></pre></div>\n<br>\n<h2>EnableBatchProcessing</h2>\n<p>Boot 3.0 이전에는 자동 구성을 활성화 하기 위해 @EnableBatchProcessing을 사용했습니다. 그러나 3.0 부터는 Spring Boot의 자동 구성을 사용하려면 제거해야합니다.</p>\n<p>@EnableBatchProcessing이나 DefaultBatchConfiguration을 확장하는 빈을 정의하면 Spring Boot의 자동 구성이 비활성화되고, 애플리케이션은 Spring Batch를 완전히 제어할 수 있습니다</p>\n<br>\r\n<center>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bec3b5c92c800a1398f4893146ac2ae0/7bf1f/enableBatchProcessing.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.229166666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyklEQVR42iWOf2+CMBCG+XduOpehUzMYtZSCpRboKKzIDzG6mGXf/+v4biZPLpfnvdydY5pRf/W5OcjCFqaNpfa3cZgoligSicfnxWTmgofpK7g3dwMcTMu8tv3FNMe6PSttWbLnIg/jPSBMeCTyCN9GKeXSpwlk8Cc5jaTTn3668TpcfqvDCfezstF1V1RtO16b4RspUJ8WBqnIykxboco0NzBOEIqApViGb7Fv7YVrj74TDu/THSph6eaDIZq7m6f58p+36QtY3QBmISYbXwoU8QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/bec3b5c92c800a1398f4893146ac2ae0/a59e9/enableBatchProcessing.webp 192w,\n/static/bec3b5c92c800a1398f4893146ac2ae0/0ca9f/enableBatchProcessing.webp 384w,\n/static/bec3b5c92c800a1398f4893146ac2ae0/dc9b9/enableBatchProcessing.webp 768w,\n/static/bec3b5c92c800a1398f4893146ac2ae0/cbe35/enableBatchProcessing.webp 938w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/bec3b5c92c800a1398f4893146ac2ae0/3b721/enableBatchProcessing.png 192w,\n/static/bec3b5c92c800a1398f4893146ac2ae0/66595/enableBatchProcessing.png 384w,\n/static/bec3b5c92c800a1398f4893146ac2ae0/fe486/enableBatchProcessing.png 768w,\n/static/bec3b5c92c800a1398f4893146ac2ae0/7bf1f/enableBatchProcessing.png 938w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/bec3b5c92c800a1398f4893146ac2ae0/fe486/enableBatchProcessing.png\"\n            alt=\"EnableBatchProcessing\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</center>\r\n<br>\n<p>@EnableBatchProcessing에 새로운 속성이 추가되어, 어떤 구성 요소와 매개변수를 사용하여 Batch 인프라 빈을 구성할지 지정할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@EnableBatchProcessing</span><span class=\"token punctuation\">(</span>dataSourceRef <span class=\"token operator\">=</span> <span class=\"token string\">\"dataSource1\"</span><span class=\"token punctuation\">,</span> transactionManagerRef <span class=\"token operator\">=</span> <span class=\"token string\">\"transactionManger1\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br>\n<h2>Hibernate Reader Deprecated</h2>\n<p>HibernateCursorItemReader, HibernatePagingItemReader, HibernateItemWriter가 Deprecated 되었습니다. (관련 Builder 클래스 포함)</p>\n<br>\r\n<center>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 407px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8476c7a828f3c9411ceeac595ddda933/fc7bc/deprecated1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.520833333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1klEQVR42lVOy07EMAzs37AbO3acpmnzbrtCWnHkwAmJI///B7hwwrJHlj0zmom8A48YyDCgWFkcC7vgeCb2VlF3CaJ4HT2Jt070dfX0vtnv9vIZb1/l9pFMqT2V6ufATH4RIrtuuY2jjTPlys6vzozIZMkYM/XAb4sZAqfA05sY5tyPXFuufStVjdZcUml9P+vY45acc3WGY8E640TMdzB3AGHcIz4inhFz4FUNxpFLK22ocn+8hiUqGQAQweKFl1gD/J3YAlng35/V0tAXkHJ0UBn/6wdpoDv6lIwVHwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8476c7a828f3c9411ceeac595ddda933/a59e9/deprecated1.webp 192w,\n/static/8476c7a828f3c9411ceeac595ddda933/0ca9f/deprecated1.webp 384w,\n/static/8476c7a828f3c9411ceeac595ddda933/6c44f/deprecated1.webp 407w\"\n              sizes=\"(max-width: 407px) 100vw, 407px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8476c7a828f3c9411ceeac595ddda933/3b721/deprecated1.png 192w,\n/static/8476c7a828f3c9411ceeac595ddda933/66595/deprecated1.png 384w,\n/static/8476c7a828f3c9411ceeac595ddda933/fc7bc/deprecated1.png 407w\"\n            sizes=\"(max-width: 407px) 100vw, 407px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8476c7a828f3c9411ceeac595ddda933/fc7bc/deprecated1.png\"\n            alt=\"HibernateCursorItemReader deprecated\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</center>\r\n<br>\n<center>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 433px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e8cbedf66b7739b8e9041218a6f9d356/842a9/deprecated2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.6875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+0lEQVR42jVOy24DMQjcr6ligwE/MPZuNt2kVQ49tb320v//ipJIRcMIEKOZBZhROZm8RMBGosQP5jKzdMnG3BL7UQkAIkDw/q/lfaSPcbprdL52UZu1NUxIgkiRmG2ufUztRsSV46yEmE4xhhCWT0u/8/Rdw4+dvjRt+3G+HGNuc9/X87Zu++V6O97ux+29j7WW/Krp3NLI0G0skpkJAjqQEiTOXJrkLLmU2pyYxWeHpwBAwaAcCwX/WTARQjSBrUBlGBI7x6Zd+3iydZs2Vvd5YuamSLmKVmkLJSKMjcH1hUAFm6B7urI2fejV1EbrVtVX8yweoUip0v4AxSlHNBTtfqEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e8cbedf66b7739b8e9041218a6f9d356/a59e9/deprecated2.webp 192w,\n/static/e8cbedf66b7739b8e9041218a6f9d356/0ca9f/deprecated2.webp 384w,\n/static/e8cbedf66b7739b8e9041218a6f9d356/4e573/deprecated2.webp 433w\"\n              sizes=\"(max-width: 433px) 100vw, 433px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e8cbedf66b7739b8e9041218a6f9d356/3b721/deprecated2.png 192w,\n/static/e8cbedf66b7739b8e9041218a6f9d356/66595/deprecated2.png 384w,\n/static/e8cbedf66b7739b8e9041218a6f9d356/842a9/deprecated2.png 433w\"\n            sizes=\"(max-width: 433px) 100vw, 433px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e8cbedf66b7739b8e9041218a6f9d356/842a9/deprecated2.png\"\n            alt=\"HibernatePagingItemReader deprecated\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</center>\r\n<br>\n<p>ps. n_1_v17 프로젝트에서 HibernatePagingItemReader를 사용하는 예시 코드를 제거하였습니다.</p>\n<br>\n<h2>JobBuilder, StepBuilder 사용 권장</h2>\n<p>JobBuilderFactory, StepBuilderFactory가 deprecated 되고 JobBuilder, StepBuilder 사용을 권장하고 있습니다.</p>\n<br>\r\n<center>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6bb3beb2a5782055e9325eebcc97565c/1d15d/factory_depreacted.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.1875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAlklEQVR42j2Naw6CMBCEuQAqikKLUOiL0paW8qh/JN7/Vq6amHyZ7CQzO8kVETNF7VYxeKac9pvxsTeBKwf2p1JPg1vrrk+z4nAGSgDupKjo8niF+FR2UWae4x62XY1rJy10hPag8ItKixtREYEbjmpW3hn0kxwRoSf+HaH9SKVpmeaDhzT7zI433AKnHEP6eEF/0qx4A5H2GPvLFY67AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6bb3beb2a5782055e9325eebcc97565c/a59e9/factory_depreacted.webp 192w,\n/static/6bb3beb2a5782055e9325eebcc97565c/0ca9f/factory_depreacted.webp 384w,\n/static/6bb3beb2a5782055e9325eebcc97565c/dc9b9/factory_depreacted.webp 768w,\n/static/6bb3beb2a5782055e9325eebcc97565c/ee9cc/factory_depreacted.webp 931w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6bb3beb2a5782055e9325eebcc97565c/3b721/factory_depreacted.png 192w,\n/static/6bb3beb2a5782055e9325eebcc97565c/66595/factory_depreacted.png 384w,\n/static/6bb3beb2a5782055e9325eebcc97565c/fe486/factory_depreacted.png 768w,\n/static/6bb3beb2a5782055e9325eebcc97565c/1d15d/factory_depreacted.png 931w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6bb3beb2a5782055e9325eebcc97565c/fe486/factory_depreacted.png\"\n            alt=\"Factory deprecated\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</center>\r\n<br>\n<h3>JobBuilderFactory, StepBuilderFactory를 deprecated 시킨 이유</h3>\n<ol>\n<li>\n<p>JobBuilderFactory는 내부적으로 JobRepository를 생성하고 설정하는데, 이 과정이 암시적으로 이루어지다보니 많은 사용자들, 특히 새로운 사용자들에게 혼란을 줄 수 있다고 했습니다.</p>\n</li>\n<li>\n<p>하나의 애플리케이션 내에서 여러 개의 JobRepository를 사용하는 경우들이 많은데 이를 변경하려면 BatchConfigurer라는 커스텀 클래스를 만들어서 JobBuilderFactory에 다른 JobRepository를 설정해야 하다보니 간편함과는 거리가 멀다고 했습니다.</p>\n</li>\n</ol>\n<p>위와 같은 이유 때문에 Spring Batch에서는 JobBuilderFactory의 사용을 권장하지 않고, 대신 더 명시적인 JobBuilder의 사용을 선호하게 되었다고 합니다.</p>\n<p>참고: <a href=\"https://github.com/spring-projects/spring-batch/issues/4188\" target=\"_blank\"><strong> Issue #4188 </strong></a></p>\n<br>\n<h3>JobRepository와 TransactionManager의 사용 방식이 명시적으로 변경</h3>\n<p>JobBuilder, StepBuilder에 기존에 name만 받던 생성자를 JobRepository도 추가로 받도록 변경되었습니다.</p>\n<br>\r\n<center>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0cb6aa75976ae2d69061b3e22da69fdb/73c8b/job_builder.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABxklEQVR42mPYcff7uvv/19/7v/rG72WXPq+59Xfd7f/r7vxfc/P38stf1t7+A5Rafxco8m/F5a9rb//ecP//pgf/1z/4v+vuN4bW+ZtCUvKjCxuicquiciqjC+qjCxrCMsuLJq1c8+R/Uc+CyMyyuOKW2PyamIK62KLG2KKm6Pz6sJzauQfvMKSV1EkKsamrSKsoSKgoSijJiSnJSkjyswfEpm9+8989JFpeRkhdQ0VNVUlNTVlVVVlFQVZZXlpZUWHyxhMMNZOXegVHhyVmBMRlBMZlBsakBcRl+gZHF7TO2Pjgf0x8momhmrWNpbGZmZm5pamJqaGRkY6Ojq6+8dTNpxlWXP607Pb/pTf/Lbv1H4GAIjf+rLn3PzwhQ1tD0djUUB8IjQ0MDPX09HS1tTW19fSnbj4F1Px56c3/y278W3bjPzJaeu3v6gf//eOztLRUjC2MDEz0DYz1gZoNDIBIV9fIaNrW0wwrr35dfOP/Egy0+NrfVQ//+0alaivLmBoZ6AGt1tU11NYGOtoYaLWm9pQtpxm23vi88sbv1Td+oaFV136uufl3ys6rXasP96w7DkJrj3WvOQpEPWuOdq09vuXyawCBXABdHCjfLQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/0cb6aa75976ae2d69061b3e22da69fdb/a59e9/job_builder.webp 192w,\n/static/0cb6aa75976ae2d69061b3e22da69fdb/0ca9f/job_builder.webp 384w,\n/static/0cb6aa75976ae2d69061b3e22da69fdb/dc9b9/job_builder.webp 768w,\n/static/0cb6aa75976ae2d69061b3e22da69fdb/e2c2f/job_builder.webp 1152w,\n/static/0cb6aa75976ae2d69061b3e22da69fdb/fe662/job_builder.webp 1273w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/0cb6aa75976ae2d69061b3e22da69fdb/3b721/job_builder.png 192w,\n/static/0cb6aa75976ae2d69061b3e22da69fdb/66595/job_builder.png 384w,\n/static/0cb6aa75976ae2d69061b3e22da69fdb/fe486/job_builder.png 768w,\n/static/0cb6aa75976ae2d69061b3e22da69fdb/d2d74/job_builder.png 1152w,\n/static/0cb6aa75976ae2d69061b3e22da69fdb/73c8b/job_builder.png 1273w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/0cb6aa75976ae2d69061b3e22da69fdb/fe486/job_builder.png\"\n            alt=\"job builder constructor\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</center>\r\n<br>\r\n<center>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d360934defe2a692d21c5c6dfaabfe53/fda7e/step_builder.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.1875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0ElEQVR42mPYduvbqpv/Vt/8s/zK90Vn3628+mPV9V8QtOLKt7W3/6y//3/dvf/r7/1fcfXb6pu/Njz4v/HB/3UP/+979JOhe/le3+iU4OT8oKS8oPjM4JQCIApMyAvLLF9w6VvphCVhybnRBfXR2RVRQJRXE5VbE5Nf559UOGH1fobynrkK0kJa6nLqqrJqQKQkraoooyglqqOhPu/cJ7/4TFlJfnUNVTU1JTVVRVU1ZWVFWVVFeQkRwaruGQwt8zbYu3h4+Pq7+gQ4+QS7ePk7+wQ5unl7+YctPP0+Mb3ISE/ZysbCyMzU1MLC1NTUyNBQT99AWVmlfuJ8huUXPyy69nfRlV9QdPU3mPF74eWfq+/9B7pZW13B1MzIwEjf0NjQyFjfwFBf31BfSVmxbsI8hpWXPy+7/X/5rX/Lbv0HouVgBGQsvfF39YP/wakFGlrKxpbGhqYGBiYGhsYGQFNMTI3VNdQaJi9gWHnly+Kb/5fc+Lfkxn9ktPjan1UP//tGp6vLihjpaepoa2lraOirqwGRiZaWgqREde9shi3XP6+48XvVjV9oaOW1n+vu/C+fsCgmszipqC6pqDaxoDo+rzIhvzKpoCoyo3jOxkMA6rnyOYb9u4IAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d360934defe2a692d21c5c6dfaabfe53/a59e9/step_builder.webp 192w,\n/static/d360934defe2a692d21c5c6dfaabfe53/0ca9f/step_builder.webp 384w,\n/static/d360934defe2a692d21c5c6dfaabfe53/dc9b9/step_builder.webp 768w,\n/static/d360934defe2a692d21c5c6dfaabfe53/e2c2f/step_builder.webp 1152w,\n/static/d360934defe2a692d21c5c6dfaabfe53/89bf1/step_builder.webp 1257w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d360934defe2a692d21c5c6dfaabfe53/3b721/step_builder.png 192w,\n/static/d360934defe2a692d21c5c6dfaabfe53/66595/step_builder.png 384w,\n/static/d360934defe2a692d21c5c6dfaabfe53/fe486/step_builder.png 768w,\n/static/d360934defe2a692d21c5c6dfaabfe53/d2d74/step_builder.png 1152w,\n/static/d360934defe2a692d21c5c6dfaabfe53/fda7e/step_builder.png 1257w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d360934defe2a692d21c5c6dfaabfe53/fe486/step_builder.png\"\n            alt=\"step builder constructor\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</center>\r\n<br>\n<p>chunk 설정을 함에 있어 size 뿐만 아니라 transactionManager도 함께 받도록 변경하였습니다.</p>\n<br>\r\n<center>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e7da069285432af9820a3a2e64ff29c0/713f0/chunk.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.645833333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA3klEQVR42jWQC27DIAxAc53xKRD8C5Qk1aSqatPt/reZIevTExiBZZupCTXhSlQJG3MTqYgLMyICgK48YiKVNAghGGPsYDrYPQRftT2WcrR2l3JQvnPKACxLmucQoneKP9HIfpiCMxdvYs4JKGYwzlt9Hi4p+DlD1OSYzFfHnGrZU01mYiTuEElfSAhF99GtIBYZtyIkkolCSr2A9z25QBCY27av+3fbbhmwLLQVKEJ13e71+rvddKh3W3+2/VWvz1L1+KxNW5qcNaq1btj5/43RmHFjXGvV8DFaF8fofxkSSA0gfnjsAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e7da069285432af9820a3a2e64ff29c0/a59e9/chunk.webp 192w,\n/static/e7da069285432af9820a3a2e64ff29c0/0ca9f/chunk.webp 384w,\n/static/e7da069285432af9820a3a2e64ff29c0/dc9b9/chunk.webp 768w,\n/static/e7da069285432af9820a3a2e64ff29c0/6f880/chunk.webp 887w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e7da069285432af9820a3a2e64ff29c0/3b721/chunk.png 192w,\n/static/e7da069285432af9820a3a2e64ff29c0/66595/chunk.png 384w,\n/static/e7da069285432af9820a3a2e64ff29c0/fe486/chunk.png 768w,\n/static/e7da069285432af9820a3a2e64ff29c0/713f0/chunk.png 887w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e7da069285432af9820a3a2e64ff29c0/fe486/chunk.png\"\n            alt=\"chunk\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</center>\r\n<br>\n<p>Batch 5.1 버전에서는 변경도 deprecated 시킴으로써 생성자를 통해 주입 받으면 이후 변경할 수 없게 되었습니다.</p>\n<p>더 명시적이고, 안정적인 방식으로 JobRepository와 TransactionManager를 관리하도록 한 것으로 보입니다.</p>\n<br>\r\n<center>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 685px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/be759d5ae2ca773a64405e17c3f95371/a31f0/deprecated3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.833333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABMElEQVR42oVR2U7DMBDM19DaXl9rr3MnTZrSSiCg4g0JiQce+P8vYN2ABBLHaGTZq509xoV2WltQoJTMB6zQmWvwgz+hYKWvnK99WmI6UpyCDcYEbZPRHrQB47m6Zr1cIaTcCqYSksW6uaZyjuU+spLmiDVSm6gl6pKLlmtZNJxmbIYrEfvkOzJoC2W1rZ0hqz13AYvgvAtIiIFpbF6KmzMdoufQWFWngY6dS1gcSd6HzW0Qc5ViCNjGOFb1Yaymnnqqdsmgl+vMPLDIA4urrdhs+VlEqzoKQ90sUzM/7KeXu93zTXteDq/nw9vj8HTyKcBXlwAuvBgmpAqp7Icx1Y0h7xBkdkeBN8qB4jt78wsK/hdC3ZQh1S0vivCZKvKs6k8UoLXKG2VN/tF/8r+J3wFrbGXsunYj0wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/be759d5ae2ca773a64405e17c3f95371/a59e9/deprecated3.webp 192w,\n/static/be759d5ae2ca773a64405e17c3f95371/0ca9f/deprecated3.webp 384w,\n/static/be759d5ae2ca773a64405e17c3f95371/ef8ff/deprecated3.webp 685w\"\n              sizes=\"(max-width: 685px) 100vw, 685px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/be759d5ae2ca773a64405e17c3f95371/3b721/deprecated3.png 192w,\n/static/be759d5ae2ca773a64405e17c3f95371/66595/deprecated3.png 384w,\n/static/be759d5ae2ca773a64405e17c3f95371/a31f0/deprecated3.png 685w\"\n            sizes=\"(max-width: 685px) 100vw, 685px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/be759d5ae2ca773a64405e17c3f95371/a31f0/deprecated3.png\"\n            alt=\"repository 변경 메서드 depreacted\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</center>\r\n<br>\n<h1>Batch 코드 비교</h1>\n<p>Reader, Processor, Writer는 변경사항이 없어 생략했습니다.</p>\n<p>전체 코드를 확인하고 싶으시면 <a href=\"https://github.com/woosungkim0123/spring-batch-deep-dive/tree/main/n_1_v17/\" target=\"_blank\"><strong>이곳 </strong></a>에서 확인하실 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// v4</span>\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CustomJpaPagingReaderBatch</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// ...</span>\r\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">JobBuilderFactory</span> jobBuilderFactory<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 5.0에서 deprecated</span>\r\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">StepBuilderFactory</span> stepBuilderFactory<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 5.0에서 deprecated</span>\r\n    <span class=\"token comment\">// ...</span>\r\n    \r\n    <span class=\"token annotation punctuation\">@Bean</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token constant\">JOB_NAME</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Job</span> <span class=\"token function\">job</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">return</span> jobBuilderFactory<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JOB_NAME</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 5.0에서 jobBuilderFactory -> JobBuilder</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token function\">step</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token annotation punctuation\">@Bean</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token constant\">STEP_NAME</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Step</span> <span class=\"token function\">step</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">return</span> stepBuilderFactory<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token constant\">STEP_NAME</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 5.0에서 stepBuilderFactory -> StepBuilder</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Store</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">StoreHistory</span><span class=\"token punctuation\">></span></span><span class=\"token function\">chunk</span><span class=\"token punctuation\">(</span>chunkSize<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 5.00에서 chunkSize, transactionManager 주입</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">reader</span><span class=\"token punctuation\">(</span>reader<span class=\"token punctuation\">.</span><span class=\"token function\">reader</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ADDRESS_PARAM</span><span class=\"token punctuation\">,</span> chunkSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">processor</span><span class=\"token punctuation\">(</span>processor<span class=\"token punctuation\">)</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">writer</span><span class=\"token punctuation\">(</span>writer<span class=\"token punctuation\">)</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token comment\">// v5</span>\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CustomJpaPagingReaderBatch</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// ...</span>\r\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">JobRepository</span> jobRepository<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 주입 1</span>\r\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">PlatformTransactionManager</span> transactionManager<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 주입 2</span>\r\n    <span class=\"token comment\">// ...</span>\r\n    \r\n    <span class=\"token annotation punctuation\">@Bean</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token constant\">JOB_NAME</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Job</span> <span class=\"token function\">job</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JobBuilder</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JOB_NAME</span><span class=\"token punctuation\">,</span> jobRepository<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 변경 사항1: JobBuilder 사용, jobRepository 주입</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token function\">step</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    \r\n    <span class=\"token annotation punctuation\">@Bean</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token constant\">STEP_NAME</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Step</span> <span class=\"token function\">step</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StepBuilder</span><span class=\"token punctuation\">(</span><span class=\"token constant\">STEP_NAME</span><span class=\"token punctuation\">,</span> jobRepository<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 변경 사항2: StepBuilder 사용, jobRepository 주입</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Store</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">StoreHistory</span><span class=\"token punctuation\">></span></span><span class=\"token function\">chunk</span><span class=\"token punctuation\">(</span>chunkSize<span class=\"token punctuation\">,</span> transactionManager<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 변경 사항3: transactionManager 주입</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">reader</span><span class=\"token punctuation\">(</span>reader<span class=\"token punctuation\">.</span><span class=\"token function\">reader</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ADDRESS_PARAM</span><span class=\"token punctuation\">,</span> chunkSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">processor</span><span class=\"token punctuation\">(</span>processor<span class=\"token punctuation\">)</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">writer</span><span class=\"token punctuation\">(</span>writer<span class=\"token punctuation\">)</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h1>참조</h1>\n<p><a href=\"https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-3.0.0-M5-Release-Notes#enablebatchprocessing-no-longer-required\" target=\"_blank\"><strong>Spring-Boot-3.0.0-M5-Release-Notes</strong></a></p>\n<p><a href=\"https://github.com/spring-projects/spring-batch/wiki/Spring-Batch-5.0-Migration-Guide\" target=\"_blank\"><strong>Spring Batch 5.0 Migration Guide</strong></a></p>","frontmatter":{"title":"Spring Batch JDK 17, Batch 5.0 이상 변경점 ","summary":"기존 Spring Batch에서 JPA 사용시 발생하는 N+1 문제에 대해서 JDK 17, Spring Batch 5.0 이상 버전에서 발생하는 변경점을 확인하고자 합니다.","date":"2023.12.16.","categories":["Spring Batch"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/webp;base64,UklGRqAAAABXRUJQVlA4IJQAAAAQBQCdASoUABQAPp1In0slpCKhqAgAsBOJZwAL0zA9ELrzyFImzsiiIrP0Ih+lU+f0AP73Vba4ym3V6VitZ+F0rwPu593dPf/2hto0LwaVNsVowEUuS8/mOVdbzPUPxdKoD9kZFwNVFp4wObhvrrUZm/6g/Bhkn2exXl7XSnmzYy+N6zimyVe3uJ7JI4mOm/AkAAAA"},"images":{"fallback":{"src":"/static/5f42a5a6da2480173de23a20325e43a4/af1dc/batch_main.webp","srcSet":"/static/5f42a5a6da2480173de23a20325e43a4/1697f/batch_main.webp 256w,\n/static/5f42a5a6da2480173de23a20325e43a4/6172c/batch_main.webp 512w,\n/static/5f42a5a6da2480173de23a20325e43a4/af1dc/batch_main.webp 1024w","sizes":"(min-width: 1024px) 1024px, 100vw"},"sources":[]},"width":1024,"height":1024}},"publicURL":"/static/5f42a5a6da2480173de23a20325e43a4/batch_main.webp"}}}}]}},"pageContext":{"slug":"/2023_12_16_batch_n_1_v17/"}},"staticQueryHashes":[],"slicesMap":{}}